/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package main.kotlin.bowlingGame

import main.kotlin.bowlingGame.model.Frame
import main.kotlin.bowlingGame.uils.BowlingUtils
import main.kotlin.bowlingGame.uils.BowlingUtils.Companion.spareBonus
import main.kotlin.bowlingGame.uils.BowlingUtils.Companion.strikeBonus

class BowlingGame {
    var playedFrames = mutableListOf<Frame>()

    fun roll(i: Int) {
        if (playedFrames.isNotEmpty() &&
                playedFrames.last().mayRollAgain()) {
            playedFrames.last().roll(i)
        } else {
            val frame = Frame()
            frame.roll(i)
            playedFrames.add(frame)
        }
    }

    fun start() {

    }

    fun score(): Int? {
        var score = 0

        for ((index, element) in playedFrames.withIndex()) {
            score += when {
                BowlingUtils.isStrike(element) -> 10 + strikeBonus(playedFrames, index)
                BowlingUtils.isSpare(element) -> 10 + spareBonus(playedFrames, index)
                else -> element.score()
            }
        }

        return score
    }
}

fun main(args: Array<String>) {
    BowlingGame().start()
}
